<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Working with Accounts - GigaWallet - A backend for your Dogecoin Business</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="Dogecoin GigaWallet is a backend service which provides a convenient integration API for platforms such as online shops, exchanges, social media platforms etc, to accept and transact Dogecoin on behalf of their users.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><li class="part-title">What is GigaWallet?</li><li class="chapter-item expanded "><a href="what.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="concepts.html"><strong aria-hidden="true">2.</strong> Basic Concepts</a></li><li class="chapter-item expanded affix "><li class="part-title">Getting Started</li><li class="chapter-item expanded "><a href="installation.html"><strong aria-hidden="true">3.</strong> Installation</a></li><li class="chapter-item expanded affix "><li class="part-title">Integration</li><li class="chapter-item expanded "><a href="accounts.html" class="active"><strong aria-hidden="true">4.</strong> Working with Accounts</a></li><li class="chapter-item expanded "><a href="invoices.html"><strong aria-hidden="true">5.</strong> Working with Invoices</a></li><li class="chapter-item expanded "><a href="connect.html"><strong aria-hidden="true">6.</strong> Doge Connect - Payment Protocol</a></li><li class="chapter-item expanded "><a href="payout.html"><strong aria-hidden="true">7.</strong> Paying Out</a></li><li class="chapter-item expanded "><a href="webhooks.html"><strong aria-hidden="true">8.</strong> Webhooks</a></li><li class="chapter-item expanded "><a href="mqtt.html"><strong aria-hidden="true">9.</strong> MQTT</a></li><li class="chapter-item expanded affix "><li class="part-title">Contributing</li><li class="chapter-item expanded "><a href="extending.html"><strong aria-hidden="true">10.</strong> Extending</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">GigaWallet - A backend for your Dogecoin Business</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/dogecoinfoundation/gigawallet/tree/main/" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/dogeorg/gigawallet-docs/edit/main/src/accounts.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="working-with-accounts"><a class="header" href="#working-with-accounts">Working with Accounts</a></h1>
<p>Gigawallet is designed as a backend component that sits within your infrastructure, and
as such is not supposed to be your system's user-database. It is designed with a fairly
generic <code>Account</code> model which can be used as you see fit to match your business needs.</p>
<p>Each <code>Account</code> within Gigawallet represents a Dogecoin HD Wallet, which is used to derive
child-addresses per <code>Invoice</code>. Accounts can list invoices, refund payments and have a
<code>Balance</code> of their own.</p>
<p>Accounts are created with a <code>Foreign ID</code> which is provided by you and links the account
to your system. Most Admin APIs use this Foreign ID to reference internal accounts so
that you can easily integrate Gigawallet with your own systems.</p>
<h2 id="different-ways-to-use-accounts-with-your-system"><a class="header" href="#different-ways-to-use-accounts-with-your-system">Different ways to use Accounts with your system</a></h2>
<h3 id="scenario-1---wholesale-store"><a class="header" href="#scenario-1---wholesale-store">Scenario 1 - Wholesale Store</a></h3>
<p>You are a wholesale business selling dog-collars, dog-leads and accessories to pet stores.
You have a <code>customers database</code> with a <code>Customer ID</code> number for each pet store. You create a
Gigawallet <code>Account</code> per customer using your <code>Customer ID</code> as the <code>Foreign ID</code>.</p>
<p>You can:</p>
<ul>
<li>Issue invoices to your customers, including shipping fees and taxes.</li>
<li>List invoices per customer.</li>
<li>Manage refunds with a 'wallet' per customer to ensure funds are accessible.</li>
<li>Check total balances received and pay those out to your central wallet when ready.</li>
</ul>
<h3 id="scenario-2---online-dogecoin-payments-saas"><a class="header" href="#scenario-2---online-dogecoin-payments-saas">Scenario 2 - Online Dogecoin Payments SaaS</a></h3>
<p>You are a payment provider like PayPal, Square, etc. And are looking for a method to
manage Dogecoin payments. You have a <code>users database</code> with a snowflake ID per user. You
create a Gigawallet <code>Account</code> per user using your snowflake ID as the <code>Foreign ID</code>.</p>
<p>You can:</p>
<ul>
<li>Issue invoices on behalf of your users.</li>
<li>Automatically pay-out to your user's cold wallet based on various thresholds.</li>
<li>Provide a realtime balance of user's funds.</li>
<li>Provide reports on payments in and out over time.</li>
</ul>
<h3 id="scenario-3---traditional-crypto-exchange"><a class="header" href="#scenario-3---traditional-crypto-exchange">Scenario 3 - Traditional Crypto Exchange</a></h3>
<p>You are a traditional Crypto Exchange managing trades on behalf of your users. Gigawallet
is configured with an account per user, consistent with your existing user databases.</p>
<p>You can:</p>
<ul>
<li>Recieve payment in Dogecoin from your users into their Dogecoin wallet for trading.</li>
<li>Pay Dogecoin to your users wallet once trading is complete.</li>
<li>Provide balance and reports on payments to and from their wallets.</li>
<li>Configure auto-payouts to your users cold-wallet so they don't leave their Dogecoin on exchanges.</li>
</ul>
<h3 id="scenario-4---global-scale-platform-ie-xcom-twitch-tv-ebay-etc"><a class="header" href="#scenario-4---global-scale-platform-ie-xcom-twitch-tv-ebay-etc">Scenario 4 - Global Scale platform ie: X.com, Twitch TV, EBay, etc.</a></h3>
<p>You are a large scale unicorn with hundreds of millions of users. Your infrastructure teams
can deploy Gigawallet in multiple configurations on your kubernetes clusters with appropriate auto-scaling
and user sharding (in development). Gigawallet integrates directly into your existing stack
with simple REST calls.</p>
<p>You can:</p>
<ul>
<li>Give each user the ability to recieve tips, accept and make payments, pay for products and subscriptions.</li>
<li>Query balances and issue payouts to users personal wallets.</li>
<li>Integrate Gigawallet directly into your messaging system (via MQTT) to trigger events when payments are confirmed.</li>
<li>Help Dogecoin gain real utility as a global currency for all humanity.</li>
</ul>
<h2 id="account-administration-apis"><a class="header" href="#account-administration-apis">Account Administration APIs</a></h2>
<h3 id="post-accountforeignid"><a class="header" href="#post-accountforeignid">POST /account/:foreignID</a></h3>
<p><em>Create or update an Account</em></p>
<p><code>:foreignID</code> is a gobal, (or shard)-unique identifier from your system which you will use
to address this <code>account</code> in subsequent requests.</p>
<p><em><strong>REQUEST BODY:</strong></em></p>
<p>Expected POST Body, an empty <code>{}</code> is fine to touch an account into existence.</p>
<pre><code class="language-js">{
  "payout_address" : "&lt;P2PKH Dogecoin Address&gt;",  // optional for auto-payout
  "payout_threshold" : "&lt;decimal amount of dogecoin before auto-payout&gt;" //optional 
  "payout_frequency" : "&lt;duration in seconds for time-based auto-payouts&gt;" //optional 
}
</code></pre>
<p><em><strong>RESPONSE BODY:</strong></em></p>
<p>Example response from <code>POST {} /account/123456789</code></p>
<pre><code class="language-js">{
    "foreign_id": "12345789",
    "id": "DRQu6WR6bpU9N4rm87PvpWZLQSqmGgphFD",
    "payout_address": "",
    "payout_frequency": "",
    "payout_threshold": "0"
}
</code></pre>
<p>Your account is now created with an HD wallet managed by Gigawallet.</p>
<h3 id="get-accountforeignid"><a class="header" href="#get-accountforeignid">GET /account/:foreignID</a></h3>
<p><em>Get an Account</em></p>
<p><em><strong>RESPONSE BODY:</strong></em></p>
<p>Example response from <code>GET /account/123456789</code></p>
<pre><code class="language-js">{
    "foreign_id": "12345789",
    "id": "DRQu6WR6bpU9N4rm87PvpWZLQSqmGgphFD",
    "payout_address": "",
    "payout_frequency": "",
    "payout_threshold": "0"
}
</code></pre>
<h3 id="get-accountforeignidbalance"><a class="header" href="#get-accountforeignidbalance">GET /account/:foreignID/balance</a></h3>
<p><em>Get an Account's AccountBalance</em></p>
<pre><code class="language-js">{
    "CurrentBalance": "1000",       // Current balance available for spending 
    "IncomingBalance": "24.89774",  // Incoming payments which have not met the confirmation threshold
    "OutgoingBalance": "0"          // Outgoing payments which have not met the confirmation threshold
}
</code></pre>
<h3 id="post-accountforeignidpay"><a class="header" href="#post-accountforeignidpay">POST /account/:foreignID/pay</a></h3>
<p><em>Send a payment from this account to an Address</em></p>
<p><em><strong>REQUEST BODY:</strong></em></p>
<pre><code class="language-js">{ "amount": "420.69, "to": "DPeTgZm7LabnmFTJkAPfADkwiKreEMmzio" } 
</code></pre>
<h2 id="account-events"><a class="header" href="#account-events">Account Events</a></h2>
<p>Events are available either via http callbacks or MQTT messages.</p>
<p>TODO</p>
<h3 id="acc_created-created"><a class="header" href="#acc_created-created">ACC_CREATED "CREATED"</a></h3>
<h3 id="acc_updated-updated"><a class="header" href="#acc_updated-updated">ACC_UPDATED "UPDATED"</a></h3>
<h3 id="acc_payment-payment"><a class="header" href="#acc_payment-payment">ACC_PAYMENT "PAYMENT"</a></h3>
<h3 id="acc_chain_activity-chain_activity"><a class="header" href="#acc_chain_activity-chain_activity">ACC_CHAIN_ACTIVITY "CHAIN_ACTIVITY"</a></h3>
<h3 id="acc_balance_change-balance_change"><a class="header" href="#acc_balance_change-balance_change">ACC_BALANCE_CHANGE "BALANCE_CHANGE"</a></h3>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="installation.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="invoices.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="installation.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="invoices.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="ace.js"></script>
        <script src="editor.js"></script>
        <script src="mode-rust.js"></script>
        <script src="theme-dawn.js"></script>
        <script src="theme-tomorrow_night.js"></script>

        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
